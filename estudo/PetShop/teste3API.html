<html>

<head>
  <title>Busca de Cep</title>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
  <link rel="stylesheet" href="./style/style.css">
</head>

<body>

  <!-- Cabeçalho -->
  <div class="header">
    <h1>Pet Shop</h1>
    <ul class="nav">
      <li>
        <a href='index.html'>Home</a>
      </li>
      <li>
        <a href="localizacao.html">Localização</a>
      </li>
      <li>
        <a href="acessorios.html">Acessorios</a>
      </li>
      <li>
        <a href="contato.html">Contatos</a>
      </li>
      <li>
        <a href="login.html">Login</a>
      </li>
    </ul>
  </div>

  <script>
    function nova() {
      location.href = "cadastro.html"
    }
  </script>

  <script>
    var app = angular.module('myApp', []);
    var result = '';

    // criando o controlador
    app.controller('myCtrl', function ($scope, $http) {
      // a��o do cli
      $scope.submit = function () {
        result = $scope.data;

        $http
          ({
            method: "GET",
            url: "https://viacep.com.br/ws/" + result + "/json/"
          }).then(function mySuccess(response) {

            if (response.data == null) {
              $scope.cepCorreto = false;
              $scope.cepIncorreto = true;
            }
            else {
              $scope.cepCorreto = true;
              $scope.cepIncorreto = false;
              $scope.data = response.data;
              var x = [$scope.data];

              $scope.cep = x[0].cep;
              $scope.logradouro = x[0].logradouro;
              $scope.complemento = x[0].complemento;
              $scope.bairro = x[0].bairro;
              $scope.localidade = x[0].localidade;
              $scope.uf = x[0].uf;
              $scope.unidade = x[0].unidade;
              $scope.ibge = x[0].ibge;
              $scope.gia = x[0].gia;
            }
          },
            function myError(response) { 
              $scope.cepIncorreto = true;
              console.error("cep não encontrado " + result);
              $scope.myWelcome = response.statusText;
            });
      };
    });                   	
  </script>

  <form style="background:#248383" ng-app="myApp" ng-submit="submit()" ng-controller="myCtrl">

    <input type="button" value="voltar" onClick="nova()" style="background:red">

    </br>
    <label>Informe um cep:</label>
    </br>
    <input type="text" ng-model="data" name="data">
    </br>
    </br>
    <input type="submit" id="submit" value="buscar" ng-submit="submit()">

    <p>cep digitado: {{data}}</p>

    </br>
    <ul ng-if="cepCorreto==true">
      <li>cep : {{cep}}</li>
      <li>logradouro : {{logradouro}}</li>
      <li>complemento : {{complemento}}</li>
      </br>
      <li>bairro : {{bairro}}</li>
      <li>localidade : {{localidade}}</li>
      <li>uf : {{uf}}</li>
      </br>
      <li>unidade : {{unidade}}</li>
      <li>ibge : {{ibge}}</li>
      <li>gia : {{gia}}</li>
    </ul>    
    </br>

    <p ng-if="cepIncorreto==true">
      cep informado está Incorreto!
    </p>

  </form>

  <!-- Rodapé -->
  <div class="rodape">
    <h6>PetShop - Todos os direitos reservados 2018 - PetShop</h6>
  </div>

</body>

</html>